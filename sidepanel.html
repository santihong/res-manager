<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åª’ä½“èµ„æºä¸‹è½½å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100%;
            min-height: 100vh;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px;
        }

        .container {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        h1 {
            font-size: 18px;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .section {
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 13px;
            font-weight: bold;
            color: #555;
            margin-bottom: 8px;
        }

        .input-group {
            margin-bottom: 12px;
        }

        label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        input[type="text"], input[type="url"] {
            width: 100%;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 12px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, input[type="url"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 14px;
            height: 14px;
            cursor: pointer;
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-size: 11px;
        }

        .btn {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .status {
            padding: 8px;
            border-radius: 6px;
            font-size: 12px;
            text-align: center;
            margin-top: 12px;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 8px;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s;
        }

        .tab-buttons {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
        }

        .tab-btn {
            flex: 1;
            padding: 6px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .network-image-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 11px;
        }

        .network-image-item:last-child {
            border-bottom: none;
        }

        .network-image-item img {
            width: 36px;
            height: 36px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }

        .network-image-info {
            flex: 1;
            min-width: 0;
        }

        .network-image-url {
            color: #333;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 3px;
        }

        .network-image-meta {
            color: #999;
            font-size: 10px;
        }

        .network-image-size {
            color: #667eea;
            font-weight: 500;
        }

        /* è®¾ç½®é¢æ¿æ ·å¼ */
        .settings-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 12px;
            border: 1px solid #e0e0e0;
        }

        .settings-title {
            font-size: 12px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .switch-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px 0;
        }

        .switch-label {
            font-size: 12px;
            color: #555;
        }

        .switch {
            position: relative;
            width: 44px;
            height: 22px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .3s;
            border-radius: 22px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        input:checked + .slider:before {
            transform: translateX(22px);
        }

        .mode-indicator {
            text-align: center;
            font-size: 11px;
            color: #667eea;
            padding: 5px;
            background: #e8ebff;
            border-radius: 4px;
            margin-top: 8px;
        }

        /* æ¨¡å¼é€‰æ‹©å™¨æ ·å¼ */
        .mode-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .mode-option {
            flex: 1;
            cursor: pointer;
        }

        .mode-option input[type="radio"] {
            display: none;
        }

        .mode-label {
            display: block;
            padding: 10px 8px;
            text-align: center;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
        }

        .mode-option input[type="radio"]:checked + .mode-label {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .mode-option:hover .mode-label {
            border-color: #667eea;
        }

        .mode-section {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ç½‘ç»œç›‘å¬æ§åˆ¶æŒ‰é’®æ ·å¼ */
        .network-controls {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .network-controls .btn {
            flex: 1;
            margin-bottom: 0;
        }

        .btn-stop {
            background: linear-gradient(135deg, #f5576c 0%, #f093fb 100%);
            color: white;
        }

        .btn-stop:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        /* èµ„æºåˆ—è¡¨æ ·å¼ */
        .resource-list {
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 8px;
            background: #fafafa;
        }

        .resource-category {
            font-size: 12px;
            color: #555;
            margin: 8px 0 4px;
            padding-bottom: 4px;
            border-bottom: 1px solid #eee;
        }
        
        .resource-category:first-child {
            margin-top: 0;
        }

        .resource-item {
            padding: 6px 8px;
            margin: 4px 0;
            background: white;
            border-radius: 4px;
            border: 1px solid #eee;
            font-size: 11px;
            cursor: default;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .resource-item:hover {
            background: #f0f0f0;
        }

        .resource-checkbox {
            width: 16px;
            height: 16px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .resource-thumb {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            object-fit: cover;
            background: #f0f0f0;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            overflow: hidden;
        }

        .resource-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .resource-info {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .resource-name {
            font-weight: 500;
            color: #333;
            word-break: break-all;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .resource-url {
            color: #888;
            font-size: 10px;
            margin-top: 2px;
            word-break: break-all;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .select-link {
            font-size: 11px;
            color: #667eea;
            text-decoration: none;
            cursor: pointer;
        }

        .select-link:hover {
            text-decoration: underline;
        }

        .select-controls {
            font-size: 11px;
        }

        /* ç¾åŒ–æ»šåŠ¨æ¡ */
        .resource-list::-webkit-scrollbar {
            width: 6px;
        }

        .resource-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .resource-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .resource-list::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <span>ğŸ“¦</span>
            åª’ä½“èµ„æºä¸‹è½½å™¨
        </h1>


        <!-- ç»Ÿä¸€çš„èµ„æºä¸‹è½½é¢æ¿ -->
        <div class="section">
            <!-- æ¨¡å¼é€‰æ‹©å™¨ -->
            <div class="section-title">ğŸ“ é€‰æ‹©æ¨¡å¼</div>
            <div class="mode-selector">
                <label class="mode-option">
                    <input type="radio" name="downloadMode" value="current" checked>
                    <span class="mode-label">ğŸŒ å½“å‰é¡µé¢</span>
                </label>
                <label class="mode-option">
                    <input type="radio" name="downloadMode" value="custom">
                    <span class="mode-label">ğŸ”— æŒ‡å®šç½‘å€</span>
                </label>
                <label class="mode-option">
                    <input type="radio" name="downloadMode" value="network">
                    <span class="mode-label">ğŸ“¡ ç½‘ç»œç›‘å¬</span>
                </label>
            </div>
            
            <!-- æŒ‡å®šURLè¾“å…¥æ¡†ï¼ˆä»…åœ¨é€‰æ‹©"æŒ‡å®šURL"æ—¶æ˜¾ç¤ºï¼‰ -->
            <div id="customUrlSection" class="mode-section" style="display: none;">
                <div class="input-group" style="margin-top: 12px;">
                    <label for="customUrl">ç›®æ ‡ç½‘é¡µURL</label>
                    <input type="url" id="customUrl" placeholder="https://example.com">
                </div>
            </div>
            
            <!-- ç½‘ç»œç›‘å¬æè¿°ï¼ˆä»…åœ¨é€‰æ‹©"ç½‘ç»œç›‘å¬"æ—¶æ˜¾ç¤ºï¼‰ -->
            <div id="networkDescSection" class="mode-section" style="display: none;">
                <p style="font-size: 11px; color: #666; margin: 12px 0 8px; padding: 8px; background: #f8f9fa; border-radius: 6px;">
                    ğŸ’¡ å®æ—¶æ•è·å½“å‰é¡µé¢çš„æ‰€æœ‰åª’ä½“ç½‘ç»œè¯·æ±‚ï¼ˆåŒ…æ‹¬åŠ¨æ€åŠ è½½çš„èµ„æºï¼‰
                </p>
            </div>
        </div>

        <!-- ç»Ÿä¸€çš„èµ„æºç±»å‹é…ç½®ï¼ˆä¸‰ç§æ¨¡å¼å…±äº«ï¼‰ -->
        <div id="resourceConfigSection">
            <div class="section">
                <!-- èµ„æºç±»å‹é€‰æ‹© -->
                <div class="section-title">ğŸ“¦ ç±»å‹</div>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="typeImage" checked>
                        <label for="typeImage">ğŸ–¼ï¸ å›¾ç‰‡</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="typeVideo">
                        <label for="typeVideo">ğŸ¬ è§†é¢‘</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="typeAudio">
                        <label for="typeAudio">ğŸµ éŸ³é¢‘</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="typeOther">
                        <label for="typeOther">ğŸ“„ å…¶å®ƒ</label>
                    </div>
                </div>

                <!-- å›¾ç‰‡æ ¼å¼è¿‡æ»¤ -->
                <div id="imageFormatFilter">
                    <div class="section-title" style="margin-top: 8px;">å›¾ç‰‡æ ¼å¼</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatJpg" checked>
                            <label for="formatJpg">JPG</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatPng" checked>
                            <label for="formatPng">PNG</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatGif" checked>
                            <label for="formatGif">GIF</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatWebp" checked>
                            <label for="formatWebp">WebP</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatSvg" checked>
                            <label for="formatSvg">SVG</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatBmp">
                            <label for="formatBmp">BMP</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatIco">
                            <label for="formatIco">ICO</label>
                        </div>
                    </div>
                </div>

                <!-- è§†é¢‘æ ¼å¼è¿‡æ»¤ -->
                <div id="videoFormatFilter" style="display: none;">
                    <div class="section-title" style="margin-top: 8px;">è§†é¢‘æ ¼å¼</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatMp4" checked>
                            <label for="formatMp4">MP4</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatWebm" checked>
                            <label for="formatWebm">WebM</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatM3u8" checked>
                            <label for="formatM3u8">M3U8/HLS</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatFlv">
                            <label for="formatFlv">FLV</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatAvi">
                            <label for="formatAvi">AVI</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatMov">
                            <label for="formatMov">MOV</label>
                        </div>
                    </div>
                </div>

                <!-- éŸ³é¢‘æ ¼å¼è¿‡æ»¤ -->
                <div id="audioFormatFilter" style="display: none;">
                    <div class="section-title" style="margin-top: 8px;">éŸ³é¢‘æ ¼å¼</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatMp3" checked>
                            <label for="formatMp3">MP3</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatWav" checked>
                            <label for="formatWav">WAV</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatOgg" checked>
                            <label for="formatOgg">OGG</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatAac">
                            <label for="formatAac">AAC</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatFlac">
                            <label for="formatFlac">FLAC</label>
                        </div>
                    </div>
                </div>

                <!-- å…¶å®ƒæ ¼å¼è¿‡æ»¤ -->
                <div id="otherFormatFilter" style="display: none;">
                    <div class="section-title" style="margin-top: 8px;">å…¶å®ƒæ ¼å¼</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatPdf" checked>
                            <label for="formatPdf">PDF</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatDoc" checked>
                            <label for="formatDoc">DOC/DOCX</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatXls" checked>
                            <label for="formatXls">XLS/XLSX</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatPpt" checked>
                            <label for="formatPpt">PPT/PPTX</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatZip" checked>
                            <label for="formatZip">ZIP/RAR</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatTxt">
                            <label for="formatTxt">TXT</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatJson">
                            <label for="formatJson">JSON</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="formatXml">
                            <label for="formatXml">XML</label>
                        </div>
                    </div>
                </div>
            </div>


            <!-- å›¾ç‰‡å°ºå¯¸è¿‡æ»¤ï¼ˆä»…å½“å‰é¡µé¢/æŒ‡å®šURLæ¨¡å¼æ˜¾ç¤ºï¼‰ -->
            <div class="section" id="sizeFilterSection">
                <div class="input-group">
                    <label for="minSize">æœ€å°å›¾ç‰‡å°ºå¯¸ (åƒç´ )</label>
                    <input type="text" id="minSize" placeholder="ä¾‹å¦‚: 100 (å®½æˆ–é«˜å¤§äº100px)" value="0">
                </div>
            </div>
        </div>

        <!-- ç»Ÿä¸€çš„æ“ä½œåŒºåŸŸï¼ˆä¸‰ç§æ¨¡å¼å…±ç”¨ï¼‰ -->
        <div id="actionSection">
            <!-- æ‰«ææŒ‰é’®ï¼ˆå½“å‰é¡µé¢/æŒ‡å®šURLæ¨¡å¼æ˜¾ç¤ºï¼‰ -->
            <button class="btn btn-primary" id="scanPage">
                ğŸ” æ‰«æèµ„æº
            </button>
            
            <!-- ç›‘å¬æ§åˆ¶æŒ‰é’®ï¼ˆç½‘ç»œç›‘å¬æ¨¡å¼æ˜¾ç¤ºï¼‰ -->
            <div class="network-controls" id="monitoringControls" style="display: none;">
                <button class="btn btn-primary" id="startMonitoring">
                    ğŸ¯ å¼€å§‹ç›‘å¬
                </button>
                <button class="btn btn-stop" id="stopMonitoring" style="display: none;">
                    â¸ï¸ åœæ­¢ç›‘å¬
                </button>
                <button class="btn btn-secondary" id="clearMonitoring">
                    ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
                </button>
            </div>
            
            <!-- ç»Ÿä¸€çš„èµ„æºåˆ—è¡¨ -->
            <div class="section" style="margin-top: 12px;">
                <div class="section-title" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ğŸ“‹ å·²å‘ç° (<span id="resourceCount">0</span>)</span>
                    <span class="select-controls" id="selectControls" style="display: none;">
                        <a href="javascript:void(0)" id="selectAll" class="select-link">å…¨é€‰</a>
                        <span style="color: #ccc; margin: 0 4px;">|</span>
                        <a href="javascript:void(0)" id="selectNone" class="select-link">å…¨ä¸é€‰</a>
                    </span>
                </div>
                <div id="resourceList" class="resource-list">
                    <p style="text-align: center; color: #999; font-size: 11px;">ç‚¹å‡»"æ‰«æèµ„æº"å¼€å§‹</p>
                </div>
            </div>
            
            <!-- ç»Ÿä¸€çš„ä¸‹è½½æŒ‰é’® -->
            <button class="btn btn-primary" id="downloadResources" style="margin-top: 8px;">
                â¬‡ï¸ ä¸‹è½½é€‰ä¸­èµ„æº (<span id="selectedCount">0</span>)
            </button>
        </div>

        <div class="progress-bar" id="progressBar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="status" id="status"></div>
        
        <!-- æ‰“å¼€ä¸‹è½½æ–‡ä»¶å¤¹æŒ‰é’® -->
        <button class="btn btn-secondary" id="openDownloadFolder" style="margin-top: 12px;">
            ğŸ“‚ æ‰“å¼€ä¸‹è½½æ–‡ä»¶å¤¹
        </button>
        
        <!-- è®¾ç½®é¢æ¿ï¼ˆç§»åˆ°åº•éƒ¨ï¼‰ -->
        <div class="settings-panel" style="margin-top: 16px;">
            <div class="settings-title">âš™ï¸ é¢æ¿è®¾ç½®</div>
            <div class="switch-container">
                <span class="switch-label">ä¾§è¾¹æ æ¨¡å¼ï¼ˆç‚¹å‡»é¡µé¢ä¸éšè—ï¼‰</span>
                <label class="switch">
                    <input type="checkbox" id="sidePanelMode" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="mode-indicator" id="modeIndicator">
                å½“å‰ï¼šä¾§è¾¹æ æ¨¡å¼ - ç‚¹å‡»é¡µé¢æˆ–åˆ·æ–°ä¸ä¼šéšè—
            </div>
        </div>
    </div>

    <script src="popup.js"></script>
    <script src="sidepanel-mode.js"></script>
</body>
</html>
