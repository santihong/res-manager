# 图片资源下载器 Chrome 插件

一个功能强大的Chrome浏览器插件，可以自动下载当前页面或指定页面的所有格式图片。

## ✨ 功能特点

- 🖼️ **多格式支持**：支持 JPG、PNG、GIF、WebP、SVG、BMP 等常见图片格式
- 📏 **尺寸过滤**：可设置最小尺寸，过滤掉小图标和缩略图
- 🎯 **三种下载模式**：
  - **当前页面模式**：下载正在浏览的页面中的所有图片
  - **指定URL模式**：输入任意网址，自动打开并下载该页面的图片
  - **Network监听模式**：实时捕获所有图片网络请求（包括动态加载、懒加载）
- 📁 **时间戳目录**：每次下载自动创建时间戳命名的子目录，方便管理
- 📊 **实时统计**：显示找到的图片数量和已下载数量
- 📐 **显示尺寸**：Network模式显示图片实际尺寸（宽×高）
- 🎨 **美观界面**：现代化的渐变UI设计，操作简单直观
- ⚡ **智能提取**：自动识别多种图片来源：
  - `<img>` 标签
  - CSS 背景图片
  - `<picture>` 标签
  - `srcset` 属性
  - 网站图标
  - Network请求中的所有图片

## 📦 安装方法

### 方法一：开发者模式安装（推荐）

1. 打开 Chrome 浏览器
2. 在地址栏输入 `chrome://extensions/` 并回车
3. 打开右上角的「开发者模式」开关
4. 点击「加载已解压的扩展程序」
5. 选择本插件的文件夹（`res-manager`）
6. 安装完成！在浏览器工具栏会出现插件图标

### 方法二：打包安装

1. 在 `chrome://extensions/` 页面
2. 点击「打包扩展程序」
3. 选择插件目录，生成 `.crx` 文件
4. 将 `.crx` 文件拖入浏览器即可安装

## 🚀 使用方法

### 下载当前页面图片

1. 打开任意包含图片的网页
2. 点击浏览器工具栏的插件图标
3. 在「当前页面」标签下：
   - 选择要下载的图片格式（可多选）
   - 设置最小尺寸（可选，0表示不限制）
   - 点击「下载当前页面图片」按钮
4. 图片会自动下载到浏览器默认下载目录的 `images` 文件夹中

### 下载指定URL页面图片

1. 点击插件图标
2. 切换到「指定URL」标签
3. 输入目标网页的完整URL（如：`https://example.com`）
4. 选择图片格式和最小尺寸
5. 点击「下载指定页面图片」按钮
6. 插件会自动打开该页面（后台），提取图片后自动关闭

### Network监听模式（新功能）

**适用场景**：捕获动态加载、懒加载、AJAX请求的图片

1. 点击插件图标
2. 切换到「Network监听」标签
3. 点击「🎯 开始监听」按钮
4. 浏览页面，滚动、点击等操作触发图片加载
5. 所有图片请求会实时显示在列表中，包括：
   - 📷 图片缩略图
   - 📏 实际尺寸（宽×高，如：1920×1080）
   - 📄 文件名
   - 🏷️ 格式类型
   - 📦 文件大小
6. 点击「下载所有捕获的图片」批量下载
7. 点击「⏸️ 停止监听」停止捕获

**详细说明**：查看 [NETWORK-MODE.md](./NETWORK-MODE.md)

## 📋 功能说明

### 图片格式选择

- **JPG/JPEG**：最常见的照片格式
- **PNG**：支持透明背景的图片格式
- **GIF**：动图格式
- **WebP**：现代化的高压缩比格式
- **SVG**：矢量图格式
- **BMP**：位图格式

### 最小尺寸过滤

设置最小尺寸可以过滤掉：
- 小图标（favicon）
- 按钮图标
- 装饰性小图片
- 缩略图

例如：设置为 `200` 表示只下载宽度或高度大于200像素的图片。

### 下载位置

每次下载会自动创建一个以时间戳命名的子目录，所有图片下载到：
```
[浏览器下载目录]/images/[时间戳]/
```

时间戳格式：`YYYYMMDD_HHMMSS`（例如：`20240213_143025`）

这样设计的好处：
- ✅ 每次下载的图片独立存放，不会混淆
- ✅ 通过目录名可以清楚知道下载时间
- ✅ 方便管理和查找不同批次的图片

如果文件名重复，会自动添加数字后缀（如：`image.jpg`、`image(1).jpg`）。

## 🛠️ 技术实现

- **Manifest V3**：使用最新的Chrome扩展API
- **权限最小化**：仅请求必要的权限
- **异步处理**：使用 async/await 确保流畅体验
- **智能提取**：多种方式识别页面中的图片资源
- **错误处理**：完善的异常捕获和用户提示

## 📁 文件结构

```
res-manager/
├── manifest.json       # 插件配置文件
├── popup.html         # 弹出窗口界面
├── popup.js           # 弹出窗口逻辑
├── background.js      # 后台服务脚本
├── icons/             # 插件图标文件夹
│   ├── icon16.png    # 16x16 图标
│   ├── icon48.png    # 48x48 图标
│   └── icon128.png   # 128x128 图标
└── README.md          # 说明文档
```

## ⚠️ 注意事项

1. **跨域限制**：某些网站可能限制图片下载，这是浏览器安全策略
2. **下载速度**：为避免触发网站限流，下载间隔设置为100ms
3. **图片数量**：如果页面图片过多，下载可能需要一些时间
4. **权限要求**：插件需要以下权限：
   - `activeTab`：访问当前标签页
   - `downloads`：下载文件
   - `storage`：保存设置
   - `scripting`：注入脚本提取图片
   - `webRequest`：监听网络请求（Network模式）

## 🔧 自定义配置

如需修改下载行为，可以编辑 `background.js` 中的下载函数：

```javascript
// 修改下载目录
filename: `images/${filename}`,  // 改为你想要的路径

// 修改下载间隔（popup.js）
await new Promise(resolve => setTimeout(resolve, 100));  // 单位：毫秒
```

## 🐛 常见问题

**Q: 为什么有些图片下载失败？**  
A: 可能是图片URL失效、跨域限制或网络问题。

**Q: 可以批量下载多个网页的图片吗？**  
A: 目前版本每次只能下载一个页面，可以多次使用插件。

**Q: 下载的图片在哪里？**  
A: 在浏览器默认下载目录的 `images/[时间戳]/` 子文件夹中，每次下载都会创建新的时间戳目录。

**Q: 为什么要用时间戳目录？**  
A: 这样可以将不同批次的下载分开存放，避免混淆，方便管理。

**Q: 如何修改下载目录？**  
A: 编辑 `background.js` 文件中的 `filename` 参数。

## 📝 更新日志

### v2.0.0 (2024-02-13)
- ✨ **重大更新**：新增Network监听模式
- 🎯 实时捕获所有图片网络请求（包括动态加载、懒加载）
- 📐 显示图片实际尺寸（宽×高）
- 📦 显示文件大小信息
- 🖼️ 图片列表显示缩略图
- 🎨 优化UI界面，三标签页设计
- 📝 新增详细的Network模式使用文档

### v1.1.0 (2024)
- ✨ 新增时间戳目录功能
- 📁 每次下载自动创建独立的时间戳子目录
- 🎯 优化下载管理，避免不同批次图片混淆

### v1.0.0 (2024)
- ✨ 初始版本发布
- 🎯 支持当前页面和指定URL两种模式
- 🖼️ 支持6种常见图片格式
- 📏 支持尺寸过滤
- 📊 实时统计和进度显示

## 📄 许可证

MIT License

## 👨‍💻 作者

Created with ❤️ by AI Assistant

---

**提示**：如果觉得这个插件有用，欢迎分享给朋友！
